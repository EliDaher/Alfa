import{r as l,g as h,k as u,h as j,j as e,D as d,P as k,B as i,l as v,a6 as P}from"./index-CB47V4bR.js";import{b as N,d as S}from"./invoices-CcAAyJLV.js";function D(){const[c,n]=l.useState(!1),[m]=l.useState("تأكيد الدفعة"),[a,y]=l.useState(null),r=h(),s=u({mutationFn:({id:t,email:x,amount:g})=>N(t,x,g),onSuccess:()=>{r.invalidateQueries({queryKey:["payment-table"]})}}),b=u({mutationFn:P,onSuccess:()=>{alert("تم حذف الدفعة."),r.invalidateQueries({queryKey:["payment-table"]})},onError:()=>{alert("حدث خطأ أثناء الإرسال.")}}),{data:o,isLoading:f}=j({queryKey:["payment-table"],queryFn:S}),p=[{key:"_id",label:"المعرف",sortable:!0,hidden:!0},{key:"destination",label:"الوجهة",sortable:!0},{key:"name",label:"الاسم",sortable:!0},{key:"number",label:"الرقم",sortable:!0},{key:"operator",label:"العملية",sortable:!0},{key:"amount",label:"المبلغ",sortable:!0},{key:"noticeNumber",label:"ملاحظة",sortable:!0},{key:"date",label:"التاريخ",sortable:!0},{key:"isConfirmed",label:"الحالة",sortable:!0},{key:"createdAt",label:"تاريخ العملية",sortable:!0}];return f?e.jsx(d,{children:e.jsx("div",{dir:"rtl",className:"space-y-6 text-center text-lg font-semibold",children:"جارِ تحميل البيانات..."})}):e.jsxs(d,{children:[e.jsx(k,{isOpen:c,setIsOpen:n,title:m,trigger:e.jsx(e.Fragment,{}),children:e.jsx("div",{className:"flex flex-row-reverse gap-2",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),a&&s.mutate({id:a._id,email:a.name,amount:a.amount}),n(!1)},className:"space-y-4 w-full",children:[a&&e.jsxs("p",{className:"text-right",children:["هل تريد تأكيد الدفعة بقيمة ",a.amount," للمستخدم"," ",e.jsx("strong",{className:"text-lg",children:a.name})]}),e.jsx(i,{disabled:!!s.isPending,type:"submit",children:s.isPending?"جاري التأكيد":"تأكيد قبول الدفعة"})]})})}),e.jsx("div",{dir:"rtl",className:"space-y-6",children:e.jsx(v,{title:"دفعات نقاط البيع",description:"",columns:p,data:o||[],renderRowActions:t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{disabled:!!s.isPending,variant:t.isConfirmed?"default":"destructive",className:"capitalize",onClick:()=>{y(t),n(!0)},children:s.isPending?"...":t.isConfirmed?"تم التأكيد":"بحاجة الى تأكيد"}),e.jsx(i,{variant:"destructive",className:"capitalize",onClick:()=>{window.confirm(`هل أنت متأكد من حذف هذه الدفعة بقيمة ${t.amount} لنقطة البيع ${t.name}؟`)&&b.mutate({id:t._id})},children:"حذف"})]})})})]})}export{D as default};
